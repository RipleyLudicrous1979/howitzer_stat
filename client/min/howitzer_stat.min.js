(function(){function m(K,G,J,I){var H;var F=g(G);if(XMLHttpRequest){H=new XMLHttpRequest();if("withCredentials" in H){H.open(K,F,true);H.onerror=I;H.onreadystatechange=function(){if(H.readyState===4){if(H.status>=200&&H.status<400){J(H.responseText)}else{I(new Error("Response returned with non-OK status"))}}};H.send(G)}}else{if(XDomainRequest){H=new XDomainRequest();H.open(K,F);H.onerror=I;H.onload=function(){J(H.responseText)};H.send(G)}else{I(new Error("CORS not supported"))}}}var g=function(F){if(F.pageName){url=window.howitzer_stat_url+"/pages/"+F.pageName}else{url=window.howitzer_stat_url+"/page_classes";if(F.url&&F.title){url+="?url="+F.url+"&title="+F.title}}return url};var w=function(F){var G=document.createElement("div");G.setAttribute("class","hs-number");G.innerHTML=F||"Not Found";var H=document.createElement("li");if(F==null){H.setAttribute("class","hs-button")}else{H.setAttribute("class","hs-button-active");H.setAttribute("style","display: block;");H.setAttribute("data-page-name",F);H.addEventListener("click",function(){if(h()){f();y()}else{i("Loading");var J=this.getAttribute("data-page-name");q(J);var I={pageName:J};m("GET",I,z,n)}})}H.appendChild(G);A().appendChild(H)};var t=function(){A().innerHTML=""};var i=function(F){A().innerHTML='<li class="hs-button"><div class="hs-number">'+F+"...</div></li>"};var k=function(F){var G=F==null?"Error":F;A().innerHTML='<li class="hs-button"><div class="hs-number error">'+G+"</div></li>"};var q=function(F){A().setAttribute("data-active-page",F)};var h=function(){return !!A().getAttribute("data-active-page")};var A=function(){return document.getElementById("hs_tooltip")};var f=function(){A().setAttribute("style","display: none")};var u=function(){A().setAttribute("style","display: block")};var b=function(){return document.getElementById("hs_popup")};var C=function(){return document.getElementById("cucumberStat")};var v=function(){return document.getElementById("hs_popup__close")};var d=function(){return document.getElementById("hs_collapse_all")};var p=function(){return document.getElementById("hs_expand_all")};var e=function(){return document.getElementsByClassName("collapsible")};var l=function(){return document.getElementsByClassName("feature-container")};var x=function(){return document.getElementsByClassName("scenario")};var j=function(F){return document.getElementById("fd_"+F)};var c=function(F){return document.getElementById("sce_items_"+F)};var r=function(){b().setAttribute("style","display: none;")};var y=function(){b().setAttribute("style","display: block;")};var D=function(F){if(F){if(F.getAttribute("style").lastIndexOf("none")==-1){F.setAttribute("style","display: none;")}else{F.setAttribute("style","")}}};var E=function(F){D(c(F))};var s=function(F){D(j(F))};var o=function(){_.each(e(),function(F){F.setAttribute("style","display: none;")})};var B=function(){_.each(e(),function(F){F.setAttribute("style","")})};var n=function(F){console.log(F);k(null)};var a=function(G){t();var F=JSON.parse(G).page;if(F.length==0){w(null)}_.each(F,function(H){w(H)})};var z=function(H){var G=A().getAttribute("data-active-page");f();t();w(G);var F=JSON.parse(H).features;if(F==""){b().innerHTML="There is no tests that include this page."}else{b().innerHTML=_.template(C().innerHTML,{features:F})}v().addEventListener("click",function(){r();u()});d().addEventListener("click",function(I){o();I.preventDefault()});p().addEventListener("click",function(I){B();I.preventDefault()});_.each(l(),function(I){var J=I.id.replace("feature_container_","");I.addEventListener("click",function(K){K.preventDefault();s(J)})});_.each(x(),function(I){var J=I.id.replace("sce_","");I.addEventListener("click",function(K){K.preventDefault();E(J)})});o();y()};window.onload=function(){var G='<ol id="hs_tooltip"></ol>\n<div id="hs_popup" style="display: none;">';document.getElementById("hs_wrapper").innerHTML=G;i("Page identification");var F={url:document.URL||window.location.href,title:document.title};m("GET",F,a,n)}})();